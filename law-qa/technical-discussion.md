# 智能法律问答应用的一些技术问题的讨论

# 目的

本文旨在讨论智能法律问答应用在开发过程中的一些技术问题，以指导进一步的设计及实现。

# 业务需求

智能法律问答应用的核心业务需求包括：

1. **快速在线响应法律咨询**：系统需快速响应用户法律咨询请求，自动生成专业、合规的答复，覆盖特定的法律专业领域。  
2. **基于法律和案件回答**：系统需检索并引用法律法规、司法解释、内部制度和历史案例，确保答复具备法律依据与实践支撑。  
3. **自动标注法律依据**：每条应答必须附带可溯源的条文或制度出处，满足法律部对规范性和可追责性的要求。  
4. **支持上下文连续的多轮问答**：面向复杂咨询场景，系统需识别用户意图变化，维持对话上下文，提升交互连续性与用户体验。  
5. **生成结构化风控报告**：对高频问题进行聚类分析与风险建模，定期输出咨询热点及潜在风险点，辅助法务团队做出策略调整。  
6. **满足企业级性能标准**：系统问答准确率达到 90% 以上，首次响应时间（TTFT）小于 3 秒，并支持数千人次的并发访问，保障大规模使用场景下的稳定性与可用性。

围绕上述需求，我们从两个方向进行技术方案讨论和设计：1）知识库的构建，2） Agent 模块的设计。

# 知识库（Knowledge Base）构建

在构建生产级别的知识库时，我们考量以下方面：

1. 数据及其处理：  
   1. 接入权威数据源（如国家法律法规数据库、企业内部法务系统等）  
   2. 分别处理不同类型（如法律法规、历史案例等）、不同格式（如 CSV、JSON、PDF、TXT 等）的数据  
   3. 预处理：清洗数据，统一格式等  
   4. 分段 (chunking)：结合段落结构、内容语义与文本长度分段，确保内容完整性与语义连续性  
   5. 元数据构建：存储数据源中已有的元数据，按需（使用 AI）提取更多的元数据，以提升检索效果（例如使用元数据过滤）

2. 检索体系：  
   1. 嵌入模型：选择法律领域的嵌入模型，或先进的通用嵌入模型；同时考虑稀疏和密集嵌入；权衡模型能力和大小  
   2. 向量数据库：选用高性能、高可扩展的向量数据库  
   3. 索引类型：选用适合当前场景的索引类型，配置合适的参数  
   4. 混合检索：支持密集检索（语义检索）、稀疏检索（全文检索）和它们的组合；支持元数据过滤  
   5. 重排：支持基于 RRF、Cross-Encoder 等的重排，进一步提升检索质量

3. 系统能力：  
   1. 系统具备高可用性、可扩展性  
   2. 系统提供安全访问机制、容灾机制  
   3. 优化性能和延迟

4. 工程化：  
   1. 编排自动化文档入库工作流，支持定时或事件驱动触发  
   2. 支持知识库的蓝绿发布或灰度发布

与此同时，法律领域的知识检索还面临以下挑战：

1. **语义鸿沟**：用户在提问时往往采用自然语言、口语化的表达方式，而法律文本则高度专业、结构化，术语严谨、语义精确。如何将用户的非正式语言有效映射到法律文本中的规范表述，跨越两者之间的语义鸿沟，是一大挑战。  
2. **术语匹配的需求**：法律文本包含大量术语和专有名词，对它们进行精确匹配是必要的功能，特定的法律术语，如 “无因管理”，专有名词如案件当事人名称“张伟”、案件中出现的地点“湖塘镇花园新村”等。  
3. **上下文的完整性**：法律文书篇幅长、逻辑链条严密。检索出的信息片段如果缺乏必要的上下文，不仅可能导致信息失真，也会严重影响大语言模型生成回答的准确性和全面性。  
4. **法律信息的时效性及数据版本管理**：法律条文会不断修订、废止，新旧版本并存。判例也有新案补充、旧案重审等动态变化。系统需要具备对法律数据源的实时同步与版本管理能力，以保障查询结果的时效性与适用性。

综合以上考量与挑战，我们引入向量数据库（Vector Database）的技术路径，选用高性能、高可扩展的 Milvus 作为底层引擎，采用多种方法提高检索质量，并且编排工作流以实现自动化发布。下面将展开讨论。

## 提升检索质量

### 多种检索方法

Milvus 提供多种检索方法以及它们的混合方法，每种方法都有其独特的优势和适用场景。为了应对复杂、多样的法律文本，实现全面、精准且高效的法律信息定位，有必要支持全部的检索方法。

#### 密集检索（Dense Retrieval）/ 语义检索（Semantic Retrieval）

密集检索利用深度学习模型将文本转化为高维度的向量（Dense Embeddings），这些向量能够捕捉文本的深层语义信息，而不仅仅是字面上的关键词。

1. **定义**： 密集检索是一种基于“语义相似性”的检索方法。它通过深度学习模型（如 BERT）将查询和文档都转换成数值向量，然后在向量空间中寻找与查询向量最接近的文档向量。这种方法的核心在于理解查询的意涵，而不是简单匹配词语。  
2. **适合解决什么问题**： 此方法非常适合处理那些使用自然语言、口语化描述，或者不包含精确法律术语的查询。当用户无法准确描述一个法律问题，但能大致描述其情境和意图时，密集检索能够超越关键词的限制，找到语义上相关的法律条文或案例。  
3. **举例说明**：  
   * **例一（模糊的自然语言提问）**：用户查询：“**楼下养的狗老是乱叫，吵得我晚上睡不着怎么办？**”  
     * **检索结果**：系统能够理解“狗乱叫影响休息”实质上属于“饲养动物妨碍他人正常生活”的问题。在法律上对应的是《民法典》第一千二百五十一条的规定：“饲养动物应当遵守法律法规，尊重社会公德，不得妨碍他人生活。”因此，它能够准确检索到该条文及相关的司法解释、判例，帮助用户了解可以通过物业协调、社区调解，甚至依法维权等方式解决问题。  
   * **例二（自然语言描述案情）**：用户查询：“**趁司机不在，偷窃货车上的加油卡，后转卖**”。  
     * **检索结果**：系统会提取这段描述的语义核心——“盗窃财物”和“转卖获利”，从而关联到“盗窃罪”的构成要件、量刑标准以及相关的案例，即使查询没有直接使用“盗窃罪”这个关键词。

#### 稀疏检索（Sparse Retrieval）/ 全文检索（Full-Text Retrieval）

稀疏检索，通常以传统的全文检索技术（如 BM25）为代表，它通过构建关键词索引来实现检索，核心是匹配查询和文档中的共同词语/token。

1. **定义**：稀疏检索是一种基于“关键词匹配”的精确检索方法。它将文本表示为一种稀疏向量（Sparse Embeddings），向量的维度对应于词汇表的大小，向量中的值则代表了特定词语在文档中的重要性（如 TF-IDF 或 BM25 分数）。这种方法对专有名词、术语、代码等具有极高的识别和匹配能力。  
2. **适合解决什么问题**： 当用户的查询包含明确的、不可替代的关键词时，稀疏检索表现最佳。这包括专有名词（人名、公司名、地名）、特定的法律术语、案件编号、法条代码等。它能确保查询中的这些关键信息被精确无误地找到。  
3. **举例说明**：  
   * **例一（专有名词）**：用户查询：“**溴氰菊酯**”。  
     * **检索结果**：系统会返回出现“溴氰菊酯”或类似文本（如“氰戊菊酯”，“溴氰菊酯”被分词为“溴/氰/菊/酯”，“氰戊菊酯”被分词为“氰/戊/菊/酯”，两者对应的稀疏嵌入，在 3 个相同的索引位置有较大值，因而相似度高）的文档，例如涉及该化学品的刑事案件或产品责任纠纷，确保了检索结果的高度相关性。  
   * **例二（地名）**：用户查询：“**湖塘镇花园新村**”。  
     * **检索结果**：系统会返回出现“湖塘镇花园新村”这一地点或类似文本的文档，实现精准定位。

#### 混合检索（Hybrid Search）

混合检索是一种将密集检索的“语义理解”能力与稀疏检索的“关键词匹配”相结合的检索策略，旨在集两者之所长，提供更全面、更精准的检索结果。

1. **定义**：混合检索是一种融合策略，它同时执行密集检索和稀疏检索，然后通过特定的算法（如 Reciprocal Rank Fusion, RRF）将两者的结果进行合并和重排序。这样，检索结果既考虑了语义上的相关性，也兼顾了关键词的精确匹配。  
2. **适合解决什么问题**：混合检索具有较强的通用性，适用于多种法律检索场景。无论是带有专业术语的复杂自然语言查询，还是较为模糊的案情描述，混合检索通常都能展现出较好的覆盖能力，在一定程度上弥补单一检索方法的不足。  
3. **举例说明**（见[附录的混合检索示例](#混合检索示例)）：  
   * **用户查询**：“**哪些罪犯适用死刑，哪些不适用？**”  
   * **检索分析**：  
     * **稀疏检索**会精确匹配关键词“**死刑**”，确保所有返回的文档都与这个核心刑罚直接相关。  
     * **密集检索**则会理解问题的深层语义，即“**适用**”与“**不适用**”的条件。它会去寻找那些讨论“死刑的适用条件”、“法定从重情节”、“法定从轻或免除情节”、“限制适用死刑的情形”（如针对孕妇、未成年人）等内容的法律条文和权威解读。  
   * **检索结果**：混合检索将两方面结果结合，最终会优先呈现那些既包含“死刑”关键词，又在内容上深入阐述了其适用与限制条件的《刑法》条文。这比单独使用一种方法更加全面。

#### 元数据检索/过滤（Metadata Filtering）

元数据是描述数据的数据，在法律文本中，它通常指案件的结构化信息，如法院、审判日期、案件类型、当事人等。元数据过滤允许在执行其他检索之前，对数据进行精确的筛选。

1. **定义**： 元数据检索/过滤是一种基于数据“结构化属性”的精确筛选方法。它允许用户根据文本之外的元数据字段（如日期、地点、类别等）设定严格的过滤条件，支持范围查询（如日期范围）、精确匹配（如法院名称）和逻辑组合（与、或、非）等复杂操作。  
2. **适合解决什么问题**： 当用户有明确的范围限制或需要对海量结果进行精确约束时，此方法至关重要。它能极大地缩小检索范围，提高检索效率和结果的准确性。元数据过滤可以与上述任意检索方法组合使用。  
3. **举例说明**（见[附录的元数据检索示例](#元数据检索示例)）：  
   * **用户查询：**“**检索辽宁省大连市中级人民法院2021年9月1日判决的民事案件**”。  
   * **执行过程**：  
     1. **元数据检索**：系统将直接应用筛选条件，而不是进行文本内容的搜索。  
        * `court = "大连市中级人民法院"`  
        * `judgment_date = "2021-09-01"`  
     2. （可选）**组合检索**：可以在上述筛选出的结果范围内，再执行一个关键词或语义查询来进一步缩小范围，例如“房屋买卖合同纠纷”。  
   * **检索结果**：系统将只返回完全符合上述所有结构化属性的判决文书，实现了对海量法律文书的精准定位。

总而言之，法律检索需要结合密集检索（捕捉语义相似性）、稀疏检索（匹配关键词精确性）、混合检索（融合多策略优势）及元数据过滤（定位结构化属性），以兼顾法律文本的复杂语义、精确术语匹配、多维度关联分析及高效筛选需求，从而实现全面、精准且高效的法律信息定位。

#### 参考

1. [https://zilliz.com/learn/sparse-and-dense-embeddings](https://zilliz.com/learn/sparse-and-dense-embeddings)  
2. [https://zilliz.com/learn/hybrid-search-combining-text-and-image](https://zilliz.com/learn/hybrid-search-combining-text-and-image)  
3. [https://milvus.io/docs/filtered-search.md](https://milvus.io/docs/filtered-search.md)

### 重排 (Reranking)

在 RAG 系统中，重排（Reranking）是提升检索质量与生成效果的关键步骤。初始检索阶段通常通过向量搜索从大规模文档中快速筛选出 top k 个候选文档，但最相关的文档可能未被排在前列。若 k 值设置较小，可能无法覆盖全部关键信息；设置较大，则由于上下文窗口限制和引入冗余信息，可能干扰 LLM 的理解与生成效果。

因此，重排可以作为第二阶段，在初筛结果中进一步排序，仅保留最相关的少量文档传递给 LLM。重排模型通常是 cross-encoder，可以同时考虑查询和文档语义，实现更精细的匹配判断，虽然其计算成本更高。通过这种“两阶段检索 \+ 精准重排”的方式，系统在保持高检索精确率和召回率的同时，也提升了生成响应的准确性与上下文契合度。

在法律领域，重排的必要性还体现在：查询表达往往含糊或歧义，仅靠向量相似度易误召、漏召；法律文书篇幅长、结构复杂，准确理解查询与文书的深层匹配关系，必须依赖更强的语言理解能力。

#### 参考

1. [https://www.pinecone.io/learn/series/rag/rerankers/](https://www.pinecone.io/learn/series/rag/rerankers/)  
2. [https://zilliz.com/learn/optimize-rag-with-rerankers-the-role-and-tradeoffs](https://zilliz.com/learn/optimize-rag-with-rerankers-the-role-and-tradeoffs)

### 索引（Index）类型选择

为实现密集检索、稀疏检索和混合检索，我们需要为每个 chunk 生成密集与稀疏两种向量，并为它们在 Milvus 向量数据库中配置适当的索引。

#### 密集向量 (Dense Vector) 与其索引

1. 向量生成：使用 Qwen3-Embedding-4B 模型生成密集向量。  
   1. Qwen3 Embedding 系列模型在当下（2025 年 6 月）达到 SOTA 性能，8B 模型在 [MTEB leaderboard](https://huggingface.co/spaces/mteb/leaderboard) 排名第一，4B 模型在性能接近 8B 模型（平均分数 69.45 vs 70.58）的情况下参数只有它的一半，在性能、速度和资源消耗之间取得了比较好的平衡。  
   2. 需要注意的是，Qwen3 Embedding 系列模型不支持生成稀疏向量。  
2. 索引选择：对于存储在内存中的大规模密集向量，选择合适的近似最近邻（ANN）索引是平衡性能、成本和精度的关键。以下是几种业界主流索引的比较：

| 索引类型 | 核心原理 | 主要优势与考量 | 典型适用场景 |
| :---- | :---- | :---- | :---- |
| IVF | 通过聚类将向量分组，并建立倒排索引（Inverted File）。搜索时先筛选部分分组（候选集），再在其中进行精确搜索。 | 优势：构建速度快，内存占用显著低于图索引。 考量：性能和精度严重依赖 nprobe (查询的候选集数量) 参数的调节。 | 中等规模数据集（百万级），对资源消耗（内存）和索引构建速度有较高要求的场景。 |
| HNSW | 构建多层图结构（Hierarchical Navigable Small World）实现高效近邻搜索，利用分层导航和贪婪路由加速查找过程。 | 优势：精度高，查询速度快。 考量：构建成本和内存占用相对较高。 | 需要低延迟和高精度查询的高维数据集。 |
| SCANN | 结合向量量化（压缩）、聚类分桶和多阶段搜索等技术来加速搜索。 | 优势：查询速度和精度优秀，内存占用较低。 考量：对硬件性能有一定要求，支持多种优化策略。 | 需要高吞吐量的大规模数据集。 |
| DiskANN | 针对磁盘（SSD）存储优化的图索引算法，将大部分数据和索引结构保存在磁盘上。 | 优势：支持海量（十亿级以上）向量索引，内存占用极低。 考量：查询速度受限于磁盘 I/O，但仍远快于暴力搜索。 | 数据规模极大，无法全部加载到内存的场景。 |

选择考量：这几种索引覆盖了从资源敏感型到性能优先型的不同需求。

应用需求要点如下：

1. 优先保障低延迟和高召回  
2. 对吞吐量要求适中  
3. [top-k 较小](https://milvus.io/docs/index-explained.md)  
4. 需保留未来扩展数据规模的能力

HNSW 在延迟与召回之间实现了良好平衡，是当前主流高性能应用中的优选方案。对于 HNSW 的参数，我们选用一套高召回率的设置（M=24、efConstruction=400），代价是需要更多的内存和构建时间。

#### 稀疏向量 (Sparse Vector) 与倒排索引

1. 向量生成：使用 BGE-M3 模型生成稀疏向量。  
   1. 当下（2025 年 6 月）支持稀疏嵌入的开源模型并不多，BGE-M3 和 Splade 是这一领域最先进的模型  
   2. 又考虑到 BGE-M3 支持多语言而 Splade 针对英文文本设计和训练，我们选择 BGE-M3 模型。  
2. 索引选择：唯一的选择就是 SPARSE\_INVERTED\_INDEX，它利用了倒排索引的原理，为稀疏数据创建了一种高效的搜索结构。

通过为不同特性的向量配置专用索引，我们能够最大化数据库的检索性能，为整个系统提供低延迟、高精度的检索能力，从而为上层的混合检索算法提供高质量的输入。

#### 参考

1. [https://milvus.io/docs/index-explained.md](https://milvus.io/docs/index-explained.md)  
2. [https://thedataquarry.com/blog/vector-db-3/](https://thedataquarry.com/blog/vector-db-3/)  
3. [https://zilliz.com/learn/bge-m3-and-splade-two-machine-learning-models-for-generating-sparse-embeddings](https://zilliz.com/learn/bge-m3-and-splade-two-machine-learning-models-for-generating-sparse-embeddings)

### 父子分段（Parent-Child Chunking）

父子分段（Parent-Child Chunking）是一种分层的文档切分与检索策略，常用于 RAG 系统。它将文档划分为两级结构：子段（child chunk）是更小的文本单元，用于提升查询的匹配精度，而父段（parent chunk）是包含子段的较大文本块，提供完整的上下文信息，供大模型生成更准确、丰富的回答。这种方法有效解决了检索中“精准 vs. 上下文”的矛盾，提升了响应质量和信息可用性。

对于裁判文书这类篇幅长、逻辑结构强的文档，设定几百长度（例如 256、512）的 chunk\_size，会导致案情描述、控辩双方观点、法院认定和判决结果等核心内容分散到多个 chunk，检索出的单个分块往往是上下文不完整的片段，不足以完整、全面地回答用户的问题。而设置更长的 chunk\_size，又会影响检索的准确性。

因此我们采用父子分段策略：向量检索基于更小粒度的子分块，以提升语义匹配的精准度；但在生成回答时，系统回溯并使用包含更加完整的上下文的父段落，确保大语言模型理解充分、回答准确。

#### 参考

1. [https://python.langchain.com/docs/how\_to/parent\_document\_retriever/](https://python.langchain.com/docs/how_to/parent_document_retriever/)  
2. [https://dify.ai/blog/introducing-parent-child-retrieval-for-enhanced-knowledge](https://dify.ai/blog/introducing-parent-child-retrieval-for-enhanced-knowledge)

### LLM 提取元数据

案件的裁判文书中包含大量的细节信息，例如日期、地点、人物、数额等，使用它们作为关键词检索时往往效果不佳（对于罕见的人名地名，采用稀疏向量检索效果尚可），可它们又确实是检索的重要参考信息。既然如此，我们可以利用 LLM 从 chunk 中提取这些关键信息作为额外的元数据，供过滤使用。

相较于依赖正则表达式（rule-based）的脆弱性和手动标注（manual）的高成本，LLM 凭借其强大的上下文理解和零样本/少样本学习能力，可以更鲁棒、更规模化地从非结构化文本中抽取出如 {"dates": "20191018", "locations": "沈阳市浑南区"} 这样的键值对。

指示 LLM 提取元数据的 prompt 见 [data/insert\_data\_cail2018.py](http://../data/insert_data_cail2018.py) 中的 `extract_metadata_with_llm` 函数。

## 系统高可用性、可扩展性与可靠性

对于一个生产级的法律知识库，其后台架构必须能支撑海量数据与高并发访问，并保障服务持续在线与数据安全。我们采用在 **Kubernetes** 上部署 **Milvus** 的云原生方案，来满足系统在**高可用**、**弹性扩展**、**数据扩容**、**数据可靠性**与**一致性**方面的严苛要求。

### 高可用性（High Availability）

高可用性关注的是服务的持续在线，即最大化减少停机时间。我们通过 Milvus 的多副本机制与 Kubernetes 的自愈能力来实现。Milvus 的无状态组件（如查询节点）可以部署多个副本，Kubernetes 会自动进行负载均衡。一旦某个副本或其所在的服务器节点发生故障，Kubernetes 会立即将其流量切换到健康副本，并自动尝试恢复故障实例，整个过程对用户透明，从而有效避免单点故障，保障服务的连续性。

### 弹性自动伸缩（Elastic Scalability）

为应对法律数据和用户查询量的动态变化，系统必须具备自动伸缩的能力。Milvus 官方维护的 [Helm Chart](https://github.com/zilliztech/milvus-helm/tree/master/charts/milvus) 内置 [**Horizontal Pod Autoscaler（HPA）**](https://kubernetes.io/zh-cn/docs/tasks/run-application/horizontal-pod-autoscale/) 了配置，可直接用于实现负载的自动伸缩。可以设定 CPU 或内存使用率等阈值，当用户查询高峰导致**查询节点（Query Node）**负载升高时，HPA 会**自动增加**其副本数量以分摊压力；当高峰过后，又会自动缩减副本数，释放闲置资源。这种自动化的弹性伸缩机制，确保了系统在任何负载下都能维持最佳的服务性能与成本效益。

### 数据扩容策略（Data Scaling Strategy）

随着业务发展，法律知识库收录的文本和向量数据规模会持续增长。处理这种可预见和超预期的增长，是架构设计中需要考虑的一环。

* **前瞻性的容量规划与资源配置**：在首次部署 Milvus 之前，进行容量规划是必要的一步。我们需要预估法律知识库在未来一段时间内可能达到的数据规模上限。基于这个预估值，可以利用 Milvus 官方提供的在线[配置工具（Sizing Tool）](https://milvus.io/tools/sizing)，精确计算出为满足该规模数据所需的各项资源，包括为 Milvus 各核心组件（如 Query Node, Index Node, Data Node）分配的 CPU、内存和磁盘规格。这种前瞻性的规划确保了初始部署的系统架构具备足够的冗余和扩展空间，能够平滑地容纳未来一段时间内数据的持续增长。  
* **平滑的在线扩容与动态弹性伸缩**：如果数据增长速度超出最初的预期，云原生架构的弹性能力便能充分发挥作用。针对基于 Kubernetes 的 Milvus 分布式部署，我们可以通过在线扩容核心组件（如 Query Node、Index Node、Data Node）的副本数，动态提升系统处理能力，实现平滑扩展。整个过程无需中断服务，且与现有运行环境无缝协同，确保在应对超预期数据增长时，依然能够提供稳定、不间断的服务。配合 HPA 机制，还可以根据负载情况实现资源的自动调整，进一步提升系统的敏捷性与资源利用率。

### 数据可靠性与一致性（Data Reliability & Consistency）

数据的可靠性与一致性是系统的生命线。Milvus 提供了多重机制来保障这一点：

* **写前日志（WAL）保障可靠性：**Milvus 使用写前日志（Write‑Ahead Log，WAL）机制，在任何插入、删除或更新操作正式落盘前，都会先将操作以追加方式记录到 WAL 中，并根据 LSN（日志序列号）严格控制写入进度。这确保了一旦系统崩溃，可通过日志重放精确恢复操作，保障数据不丢失且状态一致。  
* **多级一致性模型灵活调优**：Milvus 提供四种可调一致性级别：Strong（严格强一致）、Bounded Staleness（有界滞后/默认）、Session（会话一致）及 Eventual（最终一致）。用户可在创建集合或执行相似度搜索/查询时，通过设置 consistency\_level 参数灵活选择最适合场景的一致性策略。Strong 保证全局最新数据可读但延迟较高，Bounded 在性能与一致性间平衡，Session 保证当前会话可读写隔离，Eventual 提供最低延迟但数据可能滞后。默认使用 Bounded Staleness，以兼顾性能和一致性需求。  
* **灵活的备份与恢复**：Milvus 提供灵活且可靠的备份与恢复能力，确保数据资产的安全性与可用性。通过官方工具 Milvus Backup，可实现对集合元数据和实际数据的完整备份，并支持将数据存储到对象存储中。整个备份与恢复过程不会中断正在运行的服务，且支持通过 CLI 或 API 灵活集成到自动化流程中。用户可按需将数据恢复到原集合或新集合，有效应对灾难恢复、环境迁移等场景。

### 参考

1. [https://milvus.io/docs/architecture\_overview.md](https://milvus.io/docs/architecture_overview.md)  
2. [https://milvus.io/docs/hpa.md](https://milvus.io/docs/hpa.md)  
3. [https://milvus.io/tools/sizing](https://milvus.io/tools/sizing)  
4. [https://milvus.io/docs/milvus\_backup\_overview.md](https://milvus.io/docs/milvus_backup_overview.md)

## 知识库更新与版本管理

### 增量更新 vs. 全量更新

在维护动态的法律知识库时，我们需要选择数据更新的方法。常见的更新方式有两种：增量更新和全量更新，但它们各自面临不同的问题：

1. **增量更新（Incremental Update）**:  
   * **过程**：在现有知识库基础上，直接添加、修改或删除部分数据。  
   * **问题**：这种方式虽然快速、资源消耗小，但长期运行会导致一些问题。首先是**检索效果下降**，因为像 HNSW 这样的 ANN 索引在增量添加数据后，其图结构可能变得不均衡，导致查询性能和召回率降低。其次，复杂的更新逻辑容易引发**数据不一致**，例如，若更新流程中某个步骤失败，可能导致新旧数据共存、索引与原始数据不同步等混乱状态。  
2. **全量更新（Full Update）**:  
   * **过程**：重新建立整个知识库。这包括读取所有法律数据，重新分段、嵌入、构建新的索引。  
   * **优势**：全量更新可以从根本上解决数据不一致和索引性能衰退的问题，确保每一次发布的知识库都处于最佳的、最一致的状态。  
   * **劣势**：需要的计算量大，耗时较长，往往需要数小时甚至更久。

增量更新所带来的问题比较棘手，不容易解决，与此同时全量更新的劣势是可以克服的，因此我们采用全量更新。

### 使用 Argo 流水线自动化蓝绿发布

配合全量更新的方法，我们引入**蓝绿发布（Blue-Green Deployment）**策略，并利用 **Argo Workflows** 这一云原生工作流引擎来自动化整个发布过程。

蓝绿发布的核心思想是通过维护两套完全相同但相互独立的生产环境（“蓝色”环境和“绿色”环境）来实现零停机更新并支持版本回滚。

* **蓝色环境 (Blue)**：代表当前正在线上提供服务的、稳定运行的知识库版本（例如 v1）。  
* **绿色环境 (Green)**：代表一个全新的、离线构建的知识库版本（例如 v2）。

**Argo Workflow 驱动的发布流程如下：**

1. **触发构建**：当有新的数据或模型更新时，Argo Workflow 被触发，开始在“绿色”环境中构建一个全新的知识库。  
2. **离线全量构建**：流水线会自动执行所有建库步骤：拉取最新的全量法律数据、分段、调用 LLM 提取元数据、生成密集与稀疏向量，并为它们在 Milvus 中构建优化的 HNSW 和倒排索引。整个过程完全在离线环境中进行，不会对线上“蓝色”环境造成任何干扰。（数据处理的详细步骤参见 [https://github.com/t9k/knowledge-base-examples/tree/main/law-qa/data](https://github.com/t9k/knowledge-base-examples/tree/main/law-qa/data)。）  
3. **验证与测试**：在“绿色”环境构建完成后，Argo Workflow 会自动运行一系列预设的测试用例，以验证新知识库的数据完整性、检索准确率和查询性能是否符合上线标准。  
4. **流量切换**：一旦“绿色”环境验证通过，只需一步简单的操作（如修改网关配置），即可将所有用户流量从“蓝色”环境瞬间切换到“绿色”环境。此时，“绿色”环境正式成为新的线上服务。这个切换过程极快，用户几乎无感知，从而实现了**零停机时间**。  
5. **下线旧版**：在确认新的“蓝色”环境稳定运行一段时间后，原先的旧版环境（现在是空闲的“绿色”环境）可以被安全下线或作为下一次更新的备用环境，从而释放资源。

通过将全量更新与 Argo 流水线驱动的蓝绿发布相结合，我们既能确保法律知识库的数据一致性和最优检索性能，又能保障业务的高可用性，实现安全、可靠、无中断的知识库版本迭代。

### 参考

1. [https://help.aliyun.com/zh/mse/use-cases/service-release-strategies](https://help.aliyun.com/zh/mse/use-cases/service-release-strategies)

# Agent 设计

我们所构建的智能法律问答应用需要满足以下需求：

1. **深入理解用户意图**，即便用户的表述比较口语化或模糊。  
2. 能够以某种方式**调用工具**以灵活、精确、高效地**检索知识库**。  
3. **支持多轮对话**，有效管理对话历史，确保在持续交流中，回答能保持上下文的连贯性和准确性。  
4. ...

针对每一项需求，我们将比较多种潜在的技术方案，旨在为每个环节选择最合适的实现路径，以确保构建的 Agent 有更好的功能、表现和扩展性。

## 识别用户意图 {#识别用户意图}

识别用户意图指的是 Agent 不仅要理解用户查询的字面含义，更要洞察其背后的真实需求和目标，以采取最恰当的行动（如检索法条、分析案情或解释概念）。精准的意图识别是调用正确工具、给出有效答复的前提。

法律场景下用户意图复杂多样，现归纳为以下几类典型场景，Agent 需要具备相应的处理能力：

1. **精确信息检索**：用户目标明确，需要查找特定的法律法规或案件。  
   * 期望的处理模式：Agent 应能准确提取查询中的实体（如法律名称、法条编号、案号），并调用知识库检索工具返回原文。  
   * 例如：“查找《民法典》关于离婚冷静期的规定” 或 “检索张三诉李四的案件判决书”。  
2. **开放式法律咨询**：用户描述一个具体情境或问题，寻求法律上的解释和指导。  
   * 期望的处理模式：Agent 需要理解口语化描述，将其解构成法律关键词，进行综合检索，并整合信息生成结构化的分析和建议。  
   * 例如：“房东不退押金怎么办？” 或 “‘诉讼时效’是什么意思？”。  
3. **基于上下文的追问**：用户在多轮对话中，针对已有的回答进行深入提问。  
   * 期望的处理模式：Agent 必须理解对话历史，将“这个案子”、“那条规定”等指代词与前文关联，进行聚焦分析或补充检索。  
   * 例如：（在得到法条后）“这条规定有例外情况吗？” 或 （在看到案件后）“这个案子的主要争议点是什么？”。  
4. **复杂情景分析**：用户提供一个包含多个法律要素的复杂情况，寻求综合性的责任评估或策略建议。  
   * 期望的处理模式：Agent 需要展现出规划和推理能力，将复杂问题分解为多个子任务，依次检索分析，最后给出全面的评估。  
   * 例如：“我开车撞了闯红灯的行人，但自己也超速了，责任怎么分？”。

### 方案比选

在识别用户意图环节，考虑以下 2 种方案：

1. 启用 LLM 思考模式：Qwen3 系列模型支持思考模式（thinking mode）和非思考模式（non-thinking mode），并且在思考模式下支持设置 thinking budget。只需启用思考模式并在提示词中加以引导，LLM 就会在思考过程中识别用户意图。增加 thinking budget，LLM 对于用户意图的思考也会加深。  
2. 在 Workflow 中使用问题分类节点：在 Dify 等 LLM 应用开发平台的 Workflow 中，使用平台提供的问题分类节点，根据分类结果路由到不同的分支。

比较 2 种方案：

1. 对于预定义的多种用户意图类型，方案 2 只能依据分类结果进入单一分支；相比之下，方案 1 更加灵活，LLM 能够分解复杂问题，规划并执行多个行动路径，例如先检索法条，再检索相关判例，最后结合对话历史进行回答。  
2. 方案 1 允许用户灵活设置 thinking budget 从而影响思考的深度。

因此我们选择方案 1。

### 设计要点

启用 LLM 思考模式后，我们还需要在系统提示词中设置规则和框架，来为 Agent 的思考过程提供明确的引导、约束和目标。这套“导航系统”主要包含以下几个方面：

* **设定核心目标与角色**  
  * **作用**：从根本上规范 Agent 的行为模式。  
  * **提示词**：“法小助必须精准识别用户的真实法律意图，并基于此采取最有效的行动。”  
  * **效果**：这段引导让 Agent 的每次思考都有一个“精准识别意图”的目标，从而避免漫无目的地分析文本。  
* **建立标准化的意图分析框架**  
  * **作用**：将上面总结的四类典型场景，内化为 Agent 的思考模板。  
  * **提示词**：“请在思考过程中按以下框架进行分析和自我提问：  
    1. **意图识别**：用户的意图属于以下哪一类？ a) 精确信息检索；b) 开放式法律咨询；c) 复杂情景分析；d) 基于上下文的追问；e) 其他。  
    2. **关键信息提取**：从用户的提问中提取了哪些关键实体或法律概念？  
    3. **行动规划**：基于识别的意图，我应该采取什么行动？是基于上下文进行回答、调用检索工具，还是先分解问题再分别处理？”  
  * **效果**：这套框架将一个开放的思考过程，转化为一个有结构、有步骤的分析过程。  
* **指导行动与工具选择**  
  * **作用**：根据识别出的意图，直接指导 Agent 的行动或工具的选择。  
  * **提示词**：“如果意图是 a) 精确信息检索：调用检索工具，根据检索结果提供精准答案。”  
  * **效果**：这减少了 Agent 在选择工具时的不确定性，使其行动更有效率  
* **引入自我评估与修正机制**  
  * **作用**：提升 Agent 的健壮性，使其在面对模糊或不确定的情况时，能够做出更稳妥的决策。  
  * **提示词**：“完成意图识别后，请对你的判断给出一个置信度评分（高/中/低）。如果置信度为低，应优先选择向用户提问以获取更多信息，而不是冒险提供可能不准确的答案。”  
  * **效果**：这使得 Agent 更加“智能”和“负责”，能够识别自身能力的边界，避免因错误理解用户意图而给出误导性信息的风险。

| 提示词用于引导 LLM 产生符合预期的回答或行为，由系统提示词和用户提示词两部分组成： 系统提示词（system prompt）由开发者设定，通常包括：角色定义、背景信息、各种场景下的行为模式（即 LLM 应该/必须/可以/不能做的事情，可能有前提条件）、工具描述及调用方法； 用户提示词（user prompt）由终端用户输入，通常包括：问题、需求、（用户提供的）上下文信息、指令等信息。 需要说明的是，设定系统提示词的“开发者”可能是应用开发者、Agent 框架或 LLM API 提供商。在本问答应用中，应用开发者设定了角色定义和行为模式，而 Agent 框架注入了工具描述及调用方法。 此外，为了增强多轮对话中的指令遵循能力，开发者还可能将部分系统提示词片段嵌入用户提示词，从而更稳定地引导 LLM 按照预期行为响应。在本问答应用中，应用开发者会从第二轮对话开始，将“法小助必须精准识别用户的真实意图”等片段作为前缀拼接到用户提示词。 |
| :---- |

### 参考

1. [https://qwenlm.github.io/zh/blog/qwen3/](https://qwenlm.github.io/zh/blog/qwen3/)  
2. [https://docs.dify.ai/zh-hans/guides/workflow/node/question-classifier](https://docs.dify.ai/zh-hans/guides/workflow/node/question-classifier)

## 检索知识库

这里的关键在于确定 Agent 采用何种方式或接口集成检索工具，从而灵活、准确、高效地从知识库中检索信息。

### 方案比选

考虑以下 2 种方案：

1. 自主动态调用 MCP 工具：将多种检索方法（包含稀疏检索、密集检索、混合检索、元数据过滤、重排等）的实现封装成多个独立的 MCP 工具，通过部署 MCP Server 暴露，LLM 通过 MCP Client 调用。  
2. 在 Workflow 中使用知识检索节点：编写与 Dify 等 LLM 应用开发平台兼容的外部知识服务并部署，其中实现了多种检索方法；然后创建外部知识库连接外部知识服务，在 Workflow 中使用平台提供的知识检索节点。

比较 2 种方案：

1. 方案 1 在编写 MCP Server 时，我们可以灵活地编排工具，为工具配置适当的参数以实现精细控制，然后自主定义和实现完整的检索流程；而方案 2 的 Dify 外部知识服务只能实现一个固定的 API 端点，参数格式受限，无法扩展。例如，其请求体中无法指定使用的检索方法，也不支持添加新的工具或参数。  
2. 方案 1 部署的 MCP Server 与平台解耦，具备高度通用性。当前主流的 AI 应用开发平台（如 LangChain、Dify、n8n 等）均已支持 MCP Client，可灵活部署和迁移，亦可自主开发聊天客户端进行集成。而 Dify 的外部知识服务专属于 Dify 平台，一旦迁移到其他平台，则需重新开发，迁移成本高、通用性差。

因此考虑到可扩展性和可迁移性，我们选择方案 1。

需要说明的是，这里的方案 1 和[识别用户意图](#识别用户意图)的方案 1 是一套组合方案，这里的方案 2 和识别用户意图的方案 2 是一套组合方案（即构建 AI Workflow）。由于在这里和识别用户意图均选择方案 1，我们将放弃灵活性差、扩展性差、编排复杂的构建 AI Workflow 的方案。

### 设计要点

MCP Server 是通过标准化接口向 AI 应用开放特定能力的服务程序。每个 MCP Server 针对某一特定领域提供专门的功能，由一系列称为 MCP 工具的功能模块具体实现。

我们为每一类数据（如法律、案件）创建一个 MCP Server；在 MCP Server 中为每一部数据（如刑法、民法典）的每一种检索方法（如稀疏检索、密集检索）创建一个 MCP 工具。例如 MCP Server law-searcher 负责检索法律数据，其有如下工具：

* criminal\_law\_query：元数据检索刑法。  
* criminal\_law\_sparse\_search：稀疏检索刑法，支持元数据过滤。适用于专有名词。  
* criminal\_law\_dense\_search：密集检索刑法，支持元数据过滤。适用于基于语义的检索。  
* criminal\_law\_hybrid\_search：混合检索刑法，支持元数据过滤。适用于大多数情况。  
* civil\_code\_query：上述工具的民法典版本，下同  
* civil\_code\_sparse\_search  
* civil\_code\_dense\_search  
* civil\_code\_hybrid\_search

某一类数据下的多部数据不共用工具的原因在于：

1. 多部数据是分开维护、更新的，并且可能有不同的元数据，它们被存储在不同的 Milvus Collection（相当于数据库表）中；  
2. 工具的描述可以特定于某一部数据，更加准确；  
3. Agent 可以选择特定于某一部数据的工具，检索范围更小，粒度更细。

每一个 MCP 工具需要提供尽可能多的控制选项（如元数据过滤表达式、最多返回结果数量、分数阈值）并实现相应的功能，提供完善的工具描述和参数注解。

重排功能与任何数据类型和检索方法都无关，因此创建一个单独的 MCP Server 和 MCP 工具来实现它。（也可以将重排作为所有检索工具的一个控制选项。）

Agent 框架会将使用工具的引导，以及所有启用的 MCP 工具（包括名称、功能描述和参数规范）注入到系统提示词中（如下代码块所示）。结合 [Qwen3 系列模型对 MCP 的原生支持](https://qwenlm.github.io/zh/blog/qwen3/)，Agent 能够高效解析工具信息，准确选择并调用合适的 MCP 工具，顺利完成信息检索与处理。

| You may call one or more functions to assist with the user query.\\n\\nYou are provided with function signatures within \<tools\>\</tools\> XML tags:\\n\<tools\>\\n{"type": "function", "function": {"name": "law-searcher-criminal\_law\_query", "description": "\\\\n    使用过滤表达式查询刑法 Collection。\\\\n\\\\n    Collection 字段（元数据）说明：\\\\n\\\\n    \- law (VARCHAR): 刑法及其修正案的名称\\\\n    \- part (VARCHAR): 编\\\\n    \- chapter (VARCHAR): 章\\\\n    \- section (VARCHAR): 节\\\\n    \- article (INT64): 条\\\\n    \- article\_amended (INT64): 所修改的刑法中的条（仅适用于刑法修正案）\\\\n\\\\n    注意：\\\\n  \\\\n    1\. 刑法有十二部修正案，分别名为\\\\"中华人民共和国刑法修正案\\\\"、\\\\"中华人民共和国刑法修正案（二）\\\\"、\\\\n    \\\\"中华人民共和国刑法修正案（三）\\\\"、......、\\\\"中华人民共和国刑法修正案（十二）\\\\"。\\\\n    ", "parameters": {"type": "object", "properties": {"filter\_expr": {"description": "Filter expression, e.g. \\'law \== \\\\"中华人民共和国刑法\\\\" and article \== 123\\', \\'law like \\\\"%十一%\\\\" and article\_amended \== 338\\'", "title": "Filter Expr", "type": "string"}, "limit": {"default": 5, "description": "Maximum number of results to return", "maximum": 100, "minimum": 1, "title": "Limit", "type": "integer"}}, "required": \["filter\_expr"\]}}} ... |
| :---- |

### 参考

1. [https://github.com/zilliztech/mcp-server-milvus](https://github.com/zilliztech/mcp-server-milvus)  
2. [https://docs.dify.ai/zh-hans/guides/workflow/node/knowledge-retrieval](https://docs.dify.ai/zh-hans/guides/workflow/node/knowledge-retrieval)

## 管理多轮对话

支持多轮多对话意味着 Agent 不仅要理解用户的当前输入，还要把握其在整个对话上下文中的语义关联和逻辑连贯性。这要求我们在保留必要上下文信息的同时，还要有效控制对话历史的长度，确保其不会超过大语言模型所支持的最大上下文窗口限制。为此，需要为 Agent 设计合理的对话历史管理机制，在截断旧信息与保留关键上下文之间实现平衡，从而提升多轮对话中的连贯性和一致性。

### 方案比选

考虑以下 3 种方案：

1. 保留最近 n 个 token 的对话历史：保留最近的若干轮对话，使得 token 总数刚好不超过 n，n 可以是模型的最大上下文窗口或为了保障推理性能的其他指定值。  
2. 保留最近 k 轮对话：保留最近的 k 轮对话，k 轮之前的对话会被丢弃；若最近 k 轮对话的 token 总数超过模型的最大上下文窗口，则保留最近的若干轮对话使得刚好不超过最大上下文窗口。  
3. 滚动式摘要：在方案 1 或方案 2 的基础上，当对话超出预设的 token 长度或轮次时，调用 LLM 将早期的对话内容进行总结，形成一段摘要，并将此摘要与近期对话合并作为新的上下文。

比较 3 种方案：

1. 方案 1 通过调整 n，既可适用短对话场景，又可适用长对话场景；方案 2 适用于短对话；方案 3 适用于需要保留一些背景信息或关键信息的长对话场景  
2. 方案 1 通过限制上下文长度保障了推理性能（例如多轮对话的 TTFT）  
3. 方案 1 能够灵活适配不同的对话场景（例如每轮对话的 token 数量较少时可以保留很多轮对话）  
4. 方案 3 调用 LLM 总结引入额外的计算开销和延迟

法律问答场景下，正确全面的回答往往需要完整的上下文、严谨的表述和丰富的细节信息，有损压缩过的总结对于回答的准确性可能有不利影响。方案 3 可能不完全适用于当前场景。再考虑到方案 1 的上述优势，我们这里选择方案 1。

### 设计要点

在确定参数 n 时，需综合考虑 LLM 的最大上下文窗口限制与实际推理性能。整体策略是在不超过最大上下文窗口并且不影响推理延迟的前提下，尽可能多地保留历史信息，以增强多轮对话的上下文连贯性。

此外，为适应不同场景下的性能波动，可引入动态窗口调整机制，系统根据当前负载情况或推理延迟灵活调整 n 的值：在性能压力较小时适当增加 n，在延迟临界或资源紧张时自动减小 n，以保障服务的实时性和稳定性。

### 参考

1. [https://arxiv.org/pdf/2308.15022](https://arxiv.org/pdf/2308.15022)

# 总结和展望

我们构建了一个基于 RAG 与 MCP 框架的企业级智能法律问答应用，集成了法律法规和海量案例数据，结合多种检索方式与重排机制，并通过 LLM 提取元数据、采用父子分块策略，显著提升了检索效果和问答准确率。同时，借助 Qwen3-32B 模型驱动的智能 Agent，可动态调用工具、深入理解用户意图，满足企业对私有化部署和数据安全的高要求。

展望未来，该架构具备良好的通用性和可扩展性，有望推广至金融、医疗、科研等多个专业领域。随着数据规模不断扩大，并引入合同、规章等多样化文档，我们也将逐步构建法律知识图谱，以结构化方式表达复杂的法规和案例关联，从而进一步增强系统的理解力和可解释性，尽管这一过程在技术和资源上仍面临不小挑战。

# 附录：应用回答示例

### 混合检索示例 {#混合检索示例}

| User: 哪些罪犯适用死刑，哪些不适用？
Assistant: 
\[THINK\]
好的，用户问的是哪些罪犯适用死刑，哪些不适用。首先，我需要确定用户的意图。这看起来像是一个关于刑法的问题，特别是关于死刑适用范围的咨询。根据之前的指导方针，用户的问题属于开放式法律咨询（b类），因为涉及法律条文的解释和适用情况。

接下来，关键信息提取。用户想知道适用和不适用死刑的情况。根据中国刑法，死刑的适用有明确规定，比如刑法第四十八条到第五十条，以及修正案中的相关内容。需要检索这些法条，尤其是关于适用死刑的条件和限制。

然后考虑行动规划。用户的问题需要引用具体的法律条文，所以必须调用法律检索工具。由于用户没有提到具体的法条编号，应该使用混合检索（hybrid search）来查找相关条文。可能需要使用刑法的dense或hybrid搜索功能，输入关键词如"死刑"、"适用"、"不适用"等，并设置适当的过滤条件，比如law字段为"中华人民共和国刑法"。

另外，需要注意死刑的限制条件，例如犯罪时未满18岁、审判时怀孕的妇女不适用死刑，以及死刑缓期执行的情况。这些内容可能分布在不同的法条中，因此需要检索多个相关条款，并确保结果的全面性。

最后，根据检索结果整理出适用和不适用死刑的具体情形，并引用相关法条原文回答用户。同时，如果用户需要进一步解释，可以建议咨询专业法律人士，尤其是在涉及具体案件时。

\[TOOL*\_CALL\] law-searcher-criminal\_*law*\_hybrid\_*search
{"query*\_text": "死刑 适用条件 不适用情形", "limit": 10, "filter\_*expr": "law \== \\"中华人民共和国刑法\\""}

\[TOOL*\_RESPONSE\] law-searcher-criminal\_*law*\_hybrid\_*search
Hybrid search results for text '死刑 适用条件 不适用情形':

{'chunk\_id': '741e48cc-db79-45da-9d91-fa0687ac301e', 'distance': 0.9999999441206455, 'entity': {'chunk': '第四十九条 犯罪的时候不满十八周岁的人和审判的时候怀孕的妇女，不适用死刑。  \\n审判的时候已满七十五周岁的人，不适用死刑，但以特别残忍手段致人死亡的除外。  \\n', 'law': '中华人民共和国刑法', 'part': '第一编 总则', 'chapter': '第三章 刑罚', 'section': '第五节 死刑', 'article': 49}}

{'chunk\_id': '452ef422-35bc-454e-82e5-06544787c655', 'distance': 0.9760624244809151, 'entity': {'chunk': '第四十八条 死刑只适用于罪行极其严重的犯罪分子。对于应当判处死刑的犯罪分子，如果不是必须立即执行的，可以判处死刑同时宣告缓期二年执行。  \\n死刑除依法由最高人民法院判决的以外，都应当报请最高人民法院核准。死刑缓期执行的，可以由高级人民法院判决或者核准。  \\n', 'law': '中华人民共和国刑法', 'part': '第一编 总则', 'chapter': '第三章 刑罚', 'section': '第五节 死刑', 'article': 48}}

{'chunk\_id': '247e19b6-5ec0-4c00-8121-a996da758667', 'distance': 0.9041502196341753, 'entity': {'chunk': '第二百三十二条 故意杀人的，处死刑、无期徒刑或者十年以上有期徒刑；情节较轻的，处三年以上十年以下有期徒刑。  \\n', 'law': '中华人民共和国刑法', 'part': '第二编 分则', 'chapter': '第四章 侵犯公民人身权利、民主权利罪', 'section': '', 'article': 232}}

{'chunk\_id': '8c4147f3-41c8-474c-89f6-793614e30929', 'distance': 0.8970588268712163, 'entity': {'chunk': '第五十一条 死刑缓期执行的期间，从判决确定之日起计算。死刑缓期执行减为有期徒刑的刑期，从死刑缓期执行期满之日起计算。', 'law': '中华人民共和国刑法', 'part': '第一编 总则', 'chapter': '第三章 刑罚', 'section': '第五节 死刑', 'article': 51}}

{'chunk\_id': '8871449a-bf6a-4c7b-ae0f-dde7ae47f35a', 'distance': 0.49193546921014786, 'entity': {'chunk': '第三百四十七条 走私、贩卖、运输、制造毒品，无论数量多少，都应当追究刑事责任，予以刑事处罚。  \\n走私、贩卖、运输、制造毒品，有下列情形之一的，处十五年有期徒刑、无期徒刑或者死刑，并处没收财产：  \\n（一）走私、贩卖、运输、制造鸦片一千克以上、海洛因或者甲基苯丙胺五十克以上或者其他毒品数量大的；  \\n（二）走私、贩卖、运输、制造毒品集团的首要分子；  \\n（三）武装掩护走私、贩卖、运输、制造毒品的；  \\n（四）以暴力抗拒检查、拘留、逮捕，情节严重的；  \\n（五）参与有组织的国际贩毒活动的。  \\n走私、贩卖、运输、制造鸦片二百克以上不满一千克、海洛因或者甲基苯丙胺十克以上不满五十克或者其他毒品数量较大的，处七年以上有期徒刑，并处罚金。  \\n走私、贩卖、运输、制造鸦片不满二百克、海洛因或者甲基苯丙胺不满十克或者其他少量毒品的，处三年以下有期徒刑、拘役或者管制，并处罚金；情节严重的，处三年以上七年以下有期徒刑，并处罚金。  \\n单位犯第二款、第三款、第四款罪的，对单位判处罚金，并对其直接负责的主管人员和其他直接责任人员，依照各该款的规定处罚。  \\n利用、教唆未成年人走私、贩卖、运输、制造毒品，或者向未成年人出售毒品的，从重处罚。  \\n对多次走私、贩卖、运输、制造毒品，未经处理的，毒品数量累计计算。  \\n', 'law': '中华人民共和国刑法', 'part': '第二编 分则', 'chapter': '第六章 妨害社会管理秩序罪', 'section': '第七节 走私、贩卖、运输、制造毒品罪', 'article': 347}}

{'chunk\_id': '44149f56-89cd-4042-b1aa-a19eff41ed08', 'distance': 0.48412701208144426, 'entity': {'chunk': '第五十条 判处死刑缓期执行的，在死刑缓期执行期间，如果没有故意犯罪，二年期满以后，减为无期徒刑；如果确有重大立功表现，二年期满以后，减为二十五年有期徒刑；如果故意犯罪，情节恶劣的，报请最高人民法院核准后执行死刑；对于故意犯罪未执行死刑的，死刑缓期执行的期间重新计算，并报最高人民法院备案。  \\n对被判处死刑缓期执行的累犯以及因故意杀人、强奸、抢劫、绑架、放火、爆炸、投放危险物质或者有组织的暴力性犯罪被判处死刑缓期执行的犯罪分子，人民法院根据犯罪情节等情况可以同时决定对其限制减刑。  \\n', 'law': '中华人民共和国刑法', 'part': '第一编 总则', 'chapter': '第三章 刑罚', 'section': '第五节 死刑', 'article': 50}}

{'chunk\_id': '93921edf-c7b3-4c77-9d74-e3831fd97780', 'distance': 0.4765625, 'entity': {'chunk': '第七十四条 对于累犯和犯罪集团的首要分子，不适用缓刑。  \\n', 'law': '中华人民共和国刑法', 'part': '第一编 总则', 'chapter': '第四章 刑罚的具体运用', 'section': '第五节 缓刑', 'article': 74}}

{'chunk\_id': 'f56edb07-301a-48fb-9675-8b9763191654', 'distance': 0.4765625, 'entity': {'chunk': '第二百四十条 拐卖妇女、儿童的，处五年以上十年以下有期徒刑，并处罚金；有下列情形之一的，处十年以上有期徒刑或者无期徒刑，并处罚金或者没收财产；情节特别严重的，处死刑，并处没收财产：  \\n（一）拐卖妇女、儿童集团的首要分子；  \\n（二）拐卖妇女、儿童三人以上的；  \\n（三）奸淫被拐卖的妇女的；  \\n（四）诱骗、强迫被拐卖的妇女卖淫或者将被拐卖的妇女卖给他人迫使其卖淫的；  \\n（五）以出卖为目的，使用暴力、胁迫或者麻醉方法绑架妇女、儿童的；  \\n（六）以出卖为目的，偷盗婴幼儿的；  \\n（七）造成被拐卖的妇女、儿童或者其亲属重伤、死亡或者其他严重后果的；  \\n（八）将妇女、儿童卖往境外的。  \\n拐卖妇女、儿童是指以出卖为目的，有拐骗、绑架、收买、贩卖、接送、中转妇女、儿童的行为之一的。  \\n', 'law': '中华人民共和国刑法', 'part': '第二编 分则', 'chapter': '第四章 侵犯公民人身权利、民主权利罪', 'section': '', 'article': 240}}

{'chunk\_id': '04602b6a-2253-49c3-b2dd-7abade299838', 'distance': 0.46923076966777444, 'entity': {'chunk': '第二百六十三条 以暴力、胁迫或者其他方法抢劫公私财物的，处三年以上十年以下有期徒刑，并处罚金；有下列情形之一的，处十年以上有期徒刑、无期徒刑或者死刑，并处罚金或者没收财产：  \\n（一）入户抢劫的；  \\n（二）在公共交通工具上抢劫的；  \\n（三）抢劫银行或者其他金融机构的；  \\n（四）多次抢劫或者抢劫数额巨大的；  \\n（五）抢劫致人重伤、死亡的；  \\n（六）冒充军警人员抢劫的；  \\n（七）持枪抢劫的；  \\n（八）抢劫军用物资或者抢险、救灾、救济物资的。  \\n', 'law': '中华人民共和国刑法', 'part': '第二编 分则', 'chapter': '第五章 侵犯财产罪', 'section': '', 'article': 263}}

{'chunk\_id': 'fd54c172-a47a-4a33-869f-a3ad793f8a6b', 'distance': 0.46923076966777444, 'entity': {'chunk': '第十三条 一切危害国家主权、领土完整和安全，分裂国家、颠覆人民民主专政的政权和推翻社会主义制度，破坏社会秩序和经济秩序，侵犯国有财产或者劳动群众集体所有的财产，侵犯公民私人所有的财产，侵犯公民的人身权利、民主权利和其他权利，以及其他危害社会的行为，依照法律应当受刑罚处罚的，都是犯罪，但是情节显著轻微危害不大的，不认为是犯罪。  \\n', 'law': '中华人民共和国刑法', 'part': '第一编 总则', 'chapter': '第二章 犯罪', 'section': '第一节 犯罪和刑事责任', 'article': 13}}

\[THINK\]
好的，用户问的是哪些罪犯适用死刑，哪些不适用。首先，我需要根据提供的上下文信息来回答这个问题。从检索到的刑法条文中，可以看到几个关键点。

首先，刑法第四十八条指出，死刑只适用于罪行极其严重的犯罪分子。这说明适用死刑的前提是罪行极其严重，比如故意杀人、抢劫、贩卖毒品等重罪。同时，第四十九条规定了不适用死刑的情况，包括犯罪时未满18周岁、审判时怀孕的妇女，以及审判时年满75周岁的人（除非使用特别残忍手段致人死亡）。这些是明确的不适用情形。

接下来，其他相关条文如第二百三十二条（故意杀人）、第三百四十七条（毒品犯罪）、第二百四十条（拐卖妇女儿童）、第二百六十三条（抢劫罪）等，都列出了可能适用死刑的具体犯罪类型和情节。例如，故意杀人罪中情节较轻的可能不会判死刑，而毒品犯罪中数量大或涉及武装掩护的情况可能适用死刑。

需要确认的是，用户是否需要更详细的解释，比如具体罪名的例子或例外情况。但根据现有检索结果，已经可以总结出适用和不适用死刑的主要条件。同时，要注意到死刑缓期执行的情况，如第四十八条提到的可以判处死刑同时宣告缓期二年执行，以及第五十条关于死缓期间的处理。

最后，确保回答准确引用法条，避免主观判断，并建议用户如有复杂情况应咨询专业法律人士。现在将这些信息整理成清晰、分点的回答，确保涵盖适用和不适用的情形，并引用相关法条。

\[ANSWER\]
根据《中华人民共和国刑法》的规定，死刑的适用条件和限制情形如下：

\---

\#\#\# \*\*一、适用死刑的情形\*\*
1\. \*\*罪行极其严重\*\*  
   根据《刑法》第48条，死刑仅适用于罪行极其严重的犯罪分子。例如：
   \- \*\*故意杀人罪\*\*（第232条）：情节特别恶劣的故意杀人行为；
   \- \*\*毒品犯罪\*\*（第347条）：走私、贩卖、运输、制造毒品数量大或具有武装掩护等情节；
   \- \*\*抢劫罪\*\*（第263条）：入户抢劫、抢劫致人重伤或死亡等加重情节；
   \- \*\*拐卖妇女、儿童罪\*\*（第240条）：情节特别严重的拐卖行为（如造成被害人重伤、死亡等）。

2\. \*\*死刑执行方式\*\*  
   \- 可立即执行，或判处\*\*死刑缓期二年执行\*\*（可由高级人民法院核准）。

\---

\#\#\# \*\*二、不适用死刑的情形\*\*
1\. \*\*年龄限制\*\*  
   \- \*\*犯罪时未满18周岁\*\*（第49条）：无论罪行多严重，均不适用死刑；
   \- \*\*审判时怀孕的妇女\*\*（第49条）：不适用死刑（含死缓）。

2\. \*\*特殊保护\*\*  
   \- \*\*审判时年满75周岁的人\*\*（第49条）：一般不适用死刑，但以特别残忍手段致人死亡的除外。

\---

\#\#\# \*\*三、其他限制\*\*
\- \*\*死刑核准权\*\*：除最高人民法院判决的案件外，所有死刑案件均需报请\*\*最高人民法院核准\*\*（第48条）。
\- \*\*死缓减刑\*\*：死刑缓期执行期间若无故意犯罪，2年后减为无期徒刑；若有重大立功表现，可减为25年有期徒刑（第50条）。

\---

\#\#\# \*\*法律依据\*\*
*\> \*\*《中华人民共和国刑法》第四十八条\*\**  
*\> 死刑只适用于罪行极其严重的犯罪分子。对于应当判处死刑的犯罪分子，如果不是必须立即执行的，可以判处死刑同时宣告缓期二年执行。*  
*\> 死刑除依法由最高人民法院判决的以外，都应当报请最高人民法院核准。死刑缓期执行的，可以由高级人民法院判决或者核准。*

*\> \*\*《中华人民共和国刑法》第四十九条\*\**  
*\> 犯罪的时候不满十八周岁的人和审判的时候怀孕的妇女，不适用死刑。*  
*\> 审判的时候已满七十五周岁的人，不适用死刑，但以特别残忍手段致人死亡的除外。*

如需进一步分析具体案件或法条，建议咨询专业法律人士。 |
| :---- |

### 元数据检索示例 {#元数据检索示例}

| User: 检索辽宁省大连市中级人民法院2021年9月1日判决的民事案件

Assistant: 
\[THINK\]

好的，我现在需要处理用户的查询："检索辽宁省大连市中级人民法院2021年9月1日判决的民事案件"。首先，我要确定用户的意图。用户希望找到特定法院在特定日期判决的民事案件，这属于精确信息检索，因为用户提供了具体的法院名称和判决日期。

接下来，提取关键信息。用户提到的法院是"辽宁省大连市中级人民法院"，日期是"2021年9月1日"，案件类型是民事案件。我需要使用这些信息来构建过滤条件。

然后，选择合适的工具。用户的问题涉及民事案件，所以应该使用民事案例相关的工具。查看可用的工具，发现有case-searcher-civil*\_case\_*query函数，它允许使用过滤表达式来查询民事案例。这个函数的参数包括filter\_expr和limit。用户需要精确的日期和法院名称，所以使用过滤表达式来匹配这些条件。

构建过滤表达式时，注意法院名称要包含"辽宁省大连市中级人民法院"，而判决日期要精确到2021年9月1日。根据工具的说明，过滤表达式可以使用like操作符，例如'court like "%辽宁省大连市中级人民法院%"'和'judgment\_date like "%2021年9月1日%"'。将这两个条件用and连接起来。

设置limit参数，用户没有指定返回结果的数量，所以使用默认值10，但根据用户需求，可能需要更多结果，所以可以适当增加，但不超过最大值100。这里先用默认值10，如果结果不够，用户可以要求更多。

最后，调用case-searcher-civil*\_case\_*query函数，传入构建好的过滤表达式和limit值。确保参数正确，没有语法错误。这样应该能检索到符合条件的民事案件。

\[TOOL*\_CALL\] case-searcher-civil\_*case\_query
{"filter*\_expr": "court like \\"%辽宁省大连市中级人民法院%\\" and judgment\_*date like \\"%2021年9月1日%\\"", "limit": 10}
\[TOOL*\_RESPONSE\] case-searcher-civil\_*case\_query
Query results for 'court like "%辽宁省大连市中级人民法院%" and judgment\_date like "%2021年9月1日%"':

{'parties*\_llm': '\<none\>', 'region': '辽宁省大连市', 'judgment\_*date': '2021年9月1日', 'parties': '瓦房店金冠达轴承制造有限公司', 'case*\_cause': '加工合同纠纷', 'case\_*name': '瓦房店金冠达轴承制造有限公司、瓦房店轴承产品有限公司加工合同纠纷民事二审民事判决书', 'locations': '\<none\>', 'chunk*\_id': '007fb3a3-f7c5-47ce-b4e2-a6e14c3a3d4c', 'court': '辽宁省大连市中级人民法院', 'legal\_*basis': {'中华人民共和国民事诉讼法': \[170\]}, 'numbers': '\<none\>', 'people': '\<none\>', 'chunk': '其中第三条约定由于乙方原因造成的损失，乙方只负责赔付甲方产品的锻件和热处理费用。', 'case*\_number': '（2021）辽02民终5166号', 'parent\_*id': '83a0a382-3317-42b8-9c89-89693659472a', 'dates': '\<none\>'}

{'parties*\_llm': '青海华铁金属有限公司\\n辽宁鸿盛环境技术集团有限公司\\n\<unk\>\\n青海华铁金属有限公司', 'region': '辽宁省大连市', 'judgment\_*date': '2021年9月1日', 'parties': '青海华铁金属有限公司', 'case*\_cause': '买卖合同纠纷', 'case\_*name': '青海华铁金属有限公司、辽宁鸿盛环境技术集团有限公司买卖合同纠纷民事二审民事判决书', 'locations': '青海省涅源县申中乡卡路村\\n营口市西市区智新街\\n辽宁省大连市中山区\\n大连市', 'chunk*\_id': '0244dc8c-e473-4f80-8be5-27e79232ac53', 'court': '辽宁省大连市中级人民法院', 'legal\_*basis': {'中华人民共和国民事诉讼法': \[170\]}, 'numbers': '\<none\>', 'people': '周志明;公司员工;上诉人委托诉讼代理人\\n宋朋泽;董事长;被上诉人法定代表人\\n张晓军;律师;被上诉人委托诉讼代理人', 'chunk': '辽宁省大连市中级人民法院 民 事 判 决 书 （2021）辽02民终6733号 上诉人（原审被告）：青海华铁金属有限公司。住所地：青海省涅源县申中乡卡路村。 法定代表人：于广的，该公司执行董事。 委托诉讼代理人：周志明，男，汉族，该公司员工。 被上诉人（原审原告）：辽宁鸿盛环境技术集团有限公司。住所地：营口市西市区智新街西101号。 法定代表人：宋朋泽，该公司董事长。 委托诉讼代理人：张晓军，辽宁元久律师事务所律师。 上诉人青海华铁金属有限公司（以下简称华铁公司）因与被上诉人辽宁鸿盛环境技术集团有限公司（以下简称鸿盛公司）买卖合同纠纷一案，不服大连市中山区人民法院(2020)辽0202民初6721号民事判决，向本院提起上诉。本院于2021年8月5日立案后，依法组成合议庭对本案进行了审理。本案现已审理终结。 华铁公司上诉请求：一、撤销一审判决，改判驳回被上诉人的诉讼请求；二、本案诉讼费用由被上诉人负担。主要理由为：案涉《还款协议》是双方针对欠付的全部货款进行的协商，本身已经考虑了质保金在内的所有因素。', 'case*\_number': '（2021）辽02民终6733号', 'parent\_*id': '9a8386ad-614d-4f20-a466-1d9db57dad3b', 'dates': '20210805\\n2020\\n2021'}

{'parties*\_llm': '鸿盛公司\\n华铁公司\\n\<unk\>\\n\<unk\>', 'region': '辽宁省大连市', 'judgment\_*date': '2021年9月1日', 'parties': '青海华铁金属有限公司', 'case*\_cause': '买卖合同纠纷', 'case\_*name': '青海华铁金属有限公司、辽宁鸿盛环境技术集团有限公司买卖合同纠纷民事二审民事判决书', 'locations': '\<none\>', 'chunk*\_id': '035b7e2a-6bac-4ff6-ad29-e9be7a075298', 'court': '辽宁省大连市中级人民法院', 'legal\_*basis': {'中华人民共和国民事诉讼法': \[170\]}, 'numbers': '40万元\\n522000元\\n52200元\\n10%\\n52200元\\n2019年5月\\n2018年12月20日\\n469800元\\n40万元\\n52200元', 'people': '\<none\>', 'chunk': '一审法院认为，双方当事人对于存在买卖合同关系没有异议，争议的焦点在于双方达成的《还款协议》对于合同价款的约定是否包括质保金。虽《还款协议》约定"确认后的欠付货款40万元偿还完毕后，双方的债权债务即全部结清"，但合同的解释应遵循整体解释原则和诚实信用原则，案涉《还款协议》基于三份《除尘袋采购合同》产生，合同总价款522000元，其中10%即52200元为质保金，质保金应于两年质保期届满无质量异议后一次性付清，即应于2019年5月之后处理，而双方达成《还款协议》的时间为2018年12月20日，从时间来看，质保期未届满，是否存在质量问题尚不明确，双方对质保期未予约定合乎情理；从价款数额来看，《还款协议》明确"至本协议签订之日，欠付货款金额总计为469800元"，该数额是不含质保金的已届付款期限的货款数额，故双方达成的以40万元了结债权债务的约定应理解为仅限于到期的469800元，不含质保金。现质保期已经届满，双方无质量争议，鸿盛公司主张华铁公司偿还质保金52200元，于法有据，一审法院予以支持。', 'case*\_number': '（2021）辽02民终6733号', 'parent\_*id': '9a8386ad-614d-4f20-a466-1d9db57dad3b', 'dates': '201905\\n20181220'}

{'parties*\_llm': '上诉人\\n被上诉人\\n\<unk\>\\n\<unk\>', 'region': '辽宁省大连市', 'judgment\_*date': '2021年9月1日', 'parties': '孙景龙', 'case*\_cause': '土地租赁合同纠纷', 'case\_*name': '孙景龙、张文升土地租赁合同纠纷民事二审民事判决书', 'locations': '\<none\>', 'chunk*\_id': '03bba4fc-01c8-4083-8530-79441b78d5ba', 'court': '辽宁省大连市中级人民法院', 'legal\_*basis': {'中华人民共和国民事诉讼法': \[170\]}, 'numbers': '2000元\\n2000元\\n4000元', 'people': '\<none\>', 'chunk': '因当时桃树已大片死亡（约500余株），被上诉人不同意在未解决桃树赔偿问题的情况下提前解除合同，并拒收2000元违约金。上诉人确认收到了退回的2000元，双方事后再未就解除合同与桃树赔偿问题进行过有效协商。因此，上诉人于2020年3月17日所作的意思表示不能引起合同解除的法律后果。被上诉人提起本案诉讼，并将解除合同作为其一项诉请，故一审认定被上诉人起诉日为合同解除日并无明显不当，二审予以维持。上诉人应当继续给付2020年租金4000元，一审此判项正确，二审亦予维持。关于案涉桃树死亡的责任承担问题。2020年3月之前，上诉人因承包案涉桃园而负有经营管理桃树且承包期内损失自担的责任，上诉人关于因天气原因致桃树死亡的责任与其无关的抗辩意见于法无据，不能得到支持。因此，2020年3月之前桃树死亡的损失应由上诉人承担。2020年3月之后，上诉人向被上诉人表达了要提前解除合同的意愿，并自此不再管理桃园，导致剩余200余株桃树最终也死亡的损失发生；被上诉人在明知上诉人撂荒的情况下也未采取任何措施，放任损失扩大，双方对于该200余株桃树死亡的损失都负有责任。本院酌定上诉人承担70%的责任，被上诉人承担30%的责任。', 'case*\_number': '（2021）辽02民终7029号', 'parent\_*id': 'ad651d9e-8937-4606-8c31-d4769b34298d', 'dates': '20200317'}

{'parties*\_llm': '原告1\\n被告1\\n\<unk\>\\n\<unk\>', 'region': '辽宁省大连市', 'judgment\_*date': '2021年9月1日', 'parties': '大连豪脉房地产开发有限公司', 'case*\_cause': '商品房预售合同纠纷', 'case\_*name': '大连豪脉房地产开发有限公司、隋美丽等商品房预售合同纠纷民事二审民事判决书', 'locations': '庄河市国际商业广场\\n庄河市国际商业广场1层', 'chunk*\_id': '03f29740-239f-47e3-9176-905f9ca38df6', 'court': '辽宁省大连市中级人民法院', 'legal\_*basis': {'中华人民共和国民事诉讼法': \[170\]}, 'numbers': '579055元\\n39.29平（方）米', 'people': '隋美丽; \<unk\> ;原告（反诉被告）', 'chunk': '原告（反诉被告）于上述协议签订后向被告（反诉原告）缴纳579055元，被告（反诉原告）向原告（反诉被告）开具了发票。同日，原告（反诉被告）隋美丽作为乙方于庄河市国际商业广场有限公司作为甲方签订了《国际商业广场回租协议书》，内容为：经甲、乙双方友好协商，就甲方回租乙方在庄河市国际商业广场1层A32号39.29平（方）米（建筑面积）的产权式商铺回租给甲方用于统一经营事宜，达成如下协议：第一条产权归属1、乙方拥有该商铺的合法产权的所有权。2、乙方同意将该合法产权式商铺回租给甲方用作统一经营。3、乙方回租期满后，乙方拥有对该商铺的合法处置权（如自营、自租、产权转让）。第二条经营权归属1、甲方同意回租乙方的合法产权式商铺用作统一经营。2、甲方回租期内拥有该产权式商铺的合法资格经营管理权。3、甲方将按甲、乙双方约定的时间、租金额如期向乙方支付乙方应得的租金。第三条回租期限1、甲、乙双方约定回租期限三年，以开业之日起至三年经营期满止。2、租金计算起止时间：以开业起始之日至三年经营期满止。3、若乙方是在开业后购买的该合法产权式商铺，则租金计算起始期以本协议签订生效之日后一个月起始至本商场开业满三年止。', 'case*\_number': '（2021）辽02民终6425号', 'parent\_*id': '614b49c1-9379-405a-b8f8-fa70d11cf818', 'dates': '\<none\>'}

{'parties*\_llm': '隋国强\\n大连鸿元集装箱运输有限公司\\n隋国强\\n大连鸿元集装箱运输有限公司', 'region': '辽宁省大连市', 'judgment\_*date': '2021年9月1日', 'parties': '另案被告）', 'case*\_cause': '劳动合同纠纷', 'case\_*name': '另案被告）、另案原告）等劳动合同纠纷民事二审民事判决书', 'locations': '大连经济技术开发区', 'chunk*\_id': '0460408d-daad-4d87-a0eb-37660130315e', 'court': '辽宁省大连市中级人民法院', 'legal\_*basis': {'中华人民共和国民事诉讼法': \[170\]}, 'numbers': '75247元\\n10元\\n2元\\n8元\\n20元', 'people': '隋国强;\<unk\>;上诉人\\n\<none\>', 'chunk': '综上所述，隋国强的上诉请求成立，本院予以支持；大连鸿元集装箱运输有限公司的上诉请求不成立，本院不予支持。依照《中华人民共和国民事诉讼法》第一百七十条第一款第二项规定，判决如下：一、撤销大连经济技术开发区人民法院（2021）辽0291民初923、928号民事判决的第二项、第三项；二、变更大连经济技术开发区人民法院（2021）辽0291民初923、928号民事判决的第一项为：大连鸿元集装箱运输有限公司于本判决生效后十日内向隋国强支付未签订书面劳动合同的二倍工资差额75247元；三、驳回上诉人大连鸿元集装箱运输有限公司的上诉请求。一审案件受理费10元，由隋国强负担2元、大连鸿元集装箱运输有限公司负担8元；二审案件受理费20元，由上诉人大连鸿元集装箱运输有限公司负担。本判决为终审判决。', 'case*\_number': '（2021）辽02民终6968、6969号', 'parent\_*id': 'ce698ecd-2b8f-4810-abb4-6575928f82c2', 'dates': '\<none\>'}

{'parties*\_llm': '瓦房店市人民政府祝华街道办事处砟窑村民委员会\\n瓦房店东业轴承制造有限公司\\n瓦房店市人民政府祝华街道办事处砟窑村民委员会\\n瓦房店东业轴承制造有限公司', 'region': '辽宁省大连市', 'judgment\_*date': '2021年9月1日', 'parties': '瓦房店东业轴承制造有限公司', 'case*\_cause': '农村土地承包合同纠纷', 'case\_*name': '瓦房店东业轴承制造有限公司、瓦房店市人民政府祝华街道办事处砟窑村民委员会农村土地承包合同纠纷民事二审民事判决书', 'locations': '瓦房店市人民政府祝华街道办事处砟窑村民委员会', 'chunk*\_id': '052281fd-b7e7-499d-b51e-0ef9366ff8f3', 'court': '辽宁省大连市中级人民法院', 'legal\_*basis': {'中华人民共和国民事诉讼法': \[170\]}, 'numbers': '90115元\\n27034元\\n1321元\\n734元\\n2055元', 'people': '\<none\>', 'chunk': '综上所述，瓦房店市人民政府祝华街道办事处砟窑村民委员会合理的诉讼请求，一审法院予以支持。依照《最高人民法院关于适用时间效力的若干规定》第一条、第三条、《中华人民共和国合同法》第六十条、第一百零七条、《中华人民共和国民事诉讼法》第六十四条、《最高人民法院关于适用的解释》第九十条之规定，判决如下：一、瓦房店东业轴承制造有限公司（反诉原告）于本判决生效后立即给付瓦房店市人民政府祝华街道办事处砟窑村民委员会（反诉被告）瓦房店市人民政府祝华街道办事处砟窑村民委员会2012年3月20日至2021年3月19日土地租金90115元；二、瓦房店东业轴承制造有限公司（反诉原告）于本判决生效后立即给付瓦房店市人民政府祝华街道办事处砟窑村民委员会（反）违约金27034元；三、驳回瓦房店市人民政府祝华街道办事处砟窑村民委员会(反诉被告)的其他诉讼请求；四、驳回瓦房店东业轴承制造有限公司（反诉原告）瓦房店东业轴承制造有限公司的诉讼请求。案件受理费减半收取1321元（瓦房店市人民政府祝华街道办事处砟窑村民委员会预交），反诉费734元（瓦房店东业轴承制造有限公司预交），合计2055元，由瓦房店东业轴承制造有限公司（反诉原告）负担。', 'case*\_number': '（2021）辽02民终5168号', 'parent\_*id': '197d093c-596e-4f5f-b920-25f4522ac7ea', 'dates': '20120320\\n20210319'}

{'parties*\_llm': '孙景龙\\n张文升\\n\<unk\>\\n\<unk\>', 'region': '辽宁省大连市', 'judgment\_*date': '2021年9月1日', 'parties': '孙景龙', 'case*\_cause': '土地租赁合同纠纷', 'case\_*name': '孙景龙、张文升土地租赁合同纠纷民事二审民事判决书', 'locations': '辽宁省大连市  \\n辽宁省瓦房店市', 'chunk*\_id': '059eeb54-70f2-4b04-8cdb-55bed1c3413c', 'court': '辽宁省大连市中级人民法院', 'legal\_*basis': {'中华人民共和国民事诉讼法': \[170\]}, 'numbers': '\<none\>', 'people': '孙景龙;\<unk\>;上诉人（原审被告）  \\n邵伟;律师;上诉人委托诉讼代理人  \\n娄冰;律师;上诉人委托诉讼代理人  \\n张文升;\<unk\>;被上诉人（原审原告）  \\n骆松;律师;被上诉人委托诉讼代理人', 'chunk': '辽宁省大连市中级人民法院民 事 判 决 书（2021）辽02民终7029号上诉人（原审被告）：孙景龙，男，1971年6月10日出生，汉族，住辽宁省瓦房店市。委托诉讼代理人：邵伟，辽宁政德律师事务所律师。委托诉讼代理人：娄冰，辽宁政德律师事务所律师。被上诉人（原审原告）：张文升，男，1946年12月29日出生，汉族，住辽宁省瓦房店市。委托诉讼代理人：骆松，辽宁杰仕孚律师事务所律律师。上诉人孙景龙因与被上诉人张文升土地租赁合同纠纷案，不服瓦房店市人民法院（2021）辽0281民初2223号民事判决，向本院提起上诉。本院依法组成合议庭对本案进行了审理。本案现已审理终结。上诉人孙景龙上诉请求：撤销一审判决，发回重审或依法改判。主要事实和理由：1、2020年3月17日，上诉人已通知被上诉人不再继续履行合同，认可自己违约，不应对违约之后的扩大损失部分承担赔偿责任。2、上诉人只应承担经营桃园期间因上诉人原因导致桃树死亡的赔偿责任，不应承担因不可抗力（自然灾害）原因导致的桃树死亡的赔偿责任。被上诉人张文升不同意上诉人孙景龙的上诉请求，同意一审判决。', 'case*\_number': '（2021）辽02民终7029号', 'parent\_*id': 'ad651d9e-8937-4606-8c31-d4769b34298d', 'dates': '19710610\\n19461229\\n20210317\\n20210223'}

{'parties*\_llm': '\<none\>', 'region': '辽宁省大连市', 'judgment\_*date': '2021年9月1日', 'parties': '大连荣鑫泉贸易有限公司', 'case*\_cause': '民间借贷纠纷', 'case\_*name': '大连荣鑫泉贸易有限公司、云南聚丰农业开发有限公司民间借贷纠纷民事二审民事判决书', 'locations': '\<none\>', 'chunk*\_id': '05b480c0-ac7d-44a5-bfc7-9cdc9333df82', 'court': '辽宁省大连市中级人民法院', 'legal\_*basis': {'中华人民共和国民事诉讼法': \[170\]}, 'numbers': '171,660元', 'people': '\<none\>', 'chunk': '现原告未举证证明其于本案起诉前向被告主张过还款，故逾期利息的起算时间应自原告向本院提起诉讼时起算，即自原告于2020年10月28日向我院邮寄起诉状时起算。关于利息的标准，依据《最高人民法院关于审理民间借贷案件适用法律若干问题的规定》第二十八条第二款第一项之规定，应以原告起诉时一年期贷款市场报价利率标准，即年利率3.85%计算。原告主张的其他利息，于法无据，不予支持。关于被告辩称案涉借款系原告应自行承担的人工费、场地费的意见，一审法院认为，根据《最高人民法院关于审理民间借贷案件适用法律若干问题的规定》（法释\[2020\]17号）第十六条的规定，原告仅依据金融机构的转账凭证提起民间借贷诉讼，被告抗辩转账系偿还双方之前借款或者其他债务的，被告应当对其主张提供证据证明。本案中，原、被告签订的《采购合同》中约定被告承担货物出库前所有的费用，现被告主张与原告的合作中有原告自行承担相关费用的形式，被告对此应予举证，现被告仅提供其向员工童连红转款171,660元以及其发放工资的明细，该证据无法证明原告向被告支付的案涉款项系原告应自行承担的费用，故一审法院认为被告提供的现有证据不足以证明其主张，不予支持。', 'case*\_number': '（2021）辽02民终6378号', 'parent\_*id': '52dd5dfa-5d59-4c4d-a62c-1aec05a09085', 'dates': '20201028'}

{'parties*\_llm': '王宪法\\n石灰石矿\\n王宪法\\n石灰石矿', 'region': '辽宁省大连市', 'judgment\_*date': '2021年9月1日', 'parties': '葛秀英', 'case*\_cause': '劳动争议', 'case\_*name': '葛秀英、张淑梅等劳动争议民事二审民事判决书', 'locations': '\<none\>', 'chunk*\_id': '05c613b5-4768-4108-a9be-615720e182ce', 'court': '辽宁省大连市中级人民法院', 'legal\_*basis': {'中华人民共和国民事诉讼法': \[170\]}, 'numbers': '\<none\>', 'people': '王宪法;\<unk\>;上诉人', 'chunk': '王宪法是通过熟人介绍，由其临时雇佣来工作的，累计每月下半月发工资，由其个人的账户转到王宪法个人账户里"。上诉人先行提起本案诉讼的目的实则是为了主张工伤待遇，本案现有证据情况下虽然不能认定上诉人主张的2017年9月1日至2019年7月8日期间王宪法与石灰石矿之间存在劳动关系的待证事实成立，但并不影响上诉人向具备用工主体资格的用工单位主张工伤待遇。', 'case*\_number': '（2021）辽02民终7191号', 'parent\_*id': '76b464cc-0de2-4d2c-8cc1-dc9920037869', 'dates': '20170901\\n20190708'}

\[THINK\]

好的，我现在需要处理用户关于检索辽宁省大连市中级人民法院2021年9月1日判决的民事案件的请求。首先，回顾之前的对话，用户已经得到了相关的案件列表，现在需要根据这些信息生成一个简明准确的回答。

首先，我要确认用户的需求是获取这些案件的基本信息，可能包括案号、案件名称、当事人、案由以及法律依据等。根据提供的检索结果，共有9个案件符合要求，每个案件都有不同的案由，如加工合同纠纷、买卖合同纠纷、土地租赁合同纠纷等。

接下来，我需要检查每个案件的关键信息是否完整，并确保没有遗漏重要数据。例如，案号、案件名称、当事人、案由和法律依据都是用户可能关心的内容。同时，需要注意是否有重复的案件或信息不一致的地方。比如，有两个案件涉及孙景龙和张文升的土地租赁合同纠纷，但chunk\_id不同，可能属于同一案件的不同部分，需要合并或分别说明。

然后，我需要按照用户的要求，将这些信息以清晰的方式呈现出来。考虑到用户可能希望快速浏览结果，使用列表形式会比较合适。每个案件条目应包含案号、案件名称、当事人、案由和法律依据，必要时可以简要说明判决结果或关键点，但根据用户的问题，可能不需要过于详细的判决内容。

另外，需要注意法律依据部分，例如《中华人民共和国民事诉讼法》第170条，这可能涉及二审判决的处理方式，但用户可能不需要深入的法律分析，因此只需列出相关法条即可。

最后，确保回答符合法小助的规范，不使用Markdown格式，保持口语化，但这里需要的是正式的中文回答。同时，检查是否有需要进一步解释的地方，例如某些专业术语或复杂的法律条款，但根据用户的问题，可能不需要额外解释，保持简洁即可。

总结来说，我需要将检索到的9个案件的关键信息整理成条目列表，确保信息准确、完整，并且易于阅读。同时，注意格式的正确性和符合用户的需求。

\[ANSWER\]


根据检索结果，辽宁省大连市中级人民法院于2021年9月1日作出的民事判决案件包括以下9起：

1\. \*\*（2021）辽02民终5166号\*\*  
   \- \*\*案件名称\*\*：瓦房店金冠达轴承制造有限公司加工合同纠纷案  
   \- \*\*当事人\*\*：瓦房店金冠达轴承制造有限公司  
   \- \*\*案由\*\*：加工合同纠纷  
   \- \*\*法律依据\*\*：《中华人民共和国民事诉讼法》第170条  

2\. \*\*（2021）辽02民终6733号\*\*  
   \- \*\*案件名称\*\*：青海华铁金属有限公司买卖合同纠纷案  
   \- \*\*当事人\*\*：青海华铁金属有限公司、辽宁鸿盛环境技术集团有限公司  
   \- \*\*案由\*\*：买卖合同纠纷  
   \- \*\*法律依据\*\*：《中华人民共和国民事诉讼法》第170条  

3\. \*\*（2021）辽02民终7029号\*\*  
   \- \*\*案件名称\*\*：孙景龙土地租赁合同纠纷案  
   \- \*\*当事人\*\*：孙景龙、张文升  
   \- \*\*案由\*\*：土地租赁合同纠纷  
   \- \*\*法律依据\*\*：《中华人民共和国民事诉讼法》第170条  

4\. \*\*（2021）辽02民终6425号\*\*  
   \- \*\*案件名称\*\*：大连豪脉房地产开发有限公司商品房预售合同纠纷案  
   \- \*\*当事人\*\*：大连豪脉房地产开发有限公司、隋美丽  
   \- \*\*案由\*\*：商品房预售合同纠纷  
   \- \*\*法律依据\*\*：《中华人民共和国民事诉讼法》第170条  

5\. \*\*（2021）辽02民终6968、6969号\*\*  
   \- \*\*案件名称\*\*：隋国强劳动合同纠纷案  
   \- \*\*当事人\*\*：隋国强、大连鸿元集装箱运输有限公司  
   \- \*\*案由\*\*：劳动合同纠纷  
   \- \*\*法律依据\*\*：《中华人民共和国民事诉讼法》第170条  

6\. \*\*（2021）辽02民终5168号\*\*  
   \- \*\*案件名称\*\*：瓦房店东业轴承制造有限公司农村土地承包合同纠纷案  
   \- \*\*当事人\*\*：瓦房店东业轴承制造有限公司、瓦房店市人民政府祝华街道办事处砟窑村民委员会  
   \- \*\*案由\*\*：农村土地承包合同纠纷  
   \- \*\*法律依据\*\*：《中华人民共和国民事诉讼法》第170条  

7\. \*\*（2021）辽02民终6378号\*\*  
   \- \*\*案件名称\*\*：大连荣鑫泉贸易有限公司民间借贷纠纷案  
   \- \*\*当事人\*\*：大连荣鑫泉贸易有限公司、云南聚丰农业开发有限公司  
   \- \*\*案由\*\*：民间借贷纠纷  
   \- \*\*法律依据\*\*：《中华人民共和国民事诉讼法》第170条  

8\. \*\*（2021）辽02民终7191号\*\*  
   \- \*\*案件名称\*\*：葛秀英劳动争议案  
   \- \*\*当事人\*\*：葛秀英、张淑梅  
   \- \*\*案由\*\*：劳动争议  
   \- \*\*法律依据\*\*：《中华人民共和国民事诉讼法》第170条  \n如需进一步了解具体案件的裁判细节或法律分析，可提供案号或具体问题以获取更详细的信息。 |
| :---- |
